(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c51a4"],{"3e51":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"divBox"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"components-container"},[a("el-form",{ref:"pram",attrs:{"label-width":"150px",model:t.pram}},[a("el-form-item",{attrs:{label:"标题",prop:"title",rules:[{required:!0,message:"请填写标题",trigger:["blur","change"]}]}},[a("el-input",{attrs:{placeholder:"标题",maxlength:"100"},model:{value:t.pram.title,callback:function(e){t.$set(t.pram,"title",e)},expression:"pram.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"作者",prop:"author",rules:[{required:!0,message:"请填作者",trigger:["blur","change"]}]}},[a("el-input",{attrs:{placeholder:"作者",maxlength:"20"},model:{value:t.pram.author,callback:function(e){t.$set(t.pram,"author",e)},expression:"pram.author"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"文章分类",rules:[{required:!0,message:"请选择分类",trigger:["blur","change"]}]}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.pram.cid,callback:function(e){t.$set(t.pram,"cid",e)},expression:"pram.cid"}},t._l(t.categoryTreeData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"图文封面",prop:"imageInput",rules:[{required:!0,message:"请上传图文封面",trigger:"change"}]}},[a("div",{staticClass:"upLoadPicBox",on:{click:function(e){return t.modalPicTap("1")}}},[t.pram.imageInput?a("div",{staticClass:"pictrue"},[a("img",{attrs:{src:t.pram.imageInput}})]):a("div",{staticClass:"upLoad"},[a("i",{staticClass:"el-icon-camera cameraIconfont"})])])]),t._v(" "),a("el-form-item",{attrs:{label:"文章简介",prop:"synopsis",rules:[{required:!0,message:"请填写文章简介",trigger:["blur","change"]}]}},[a("el-input",{attrs:{maxlength:"100",type:"textarea",rows:2,resize:"none",placeholder:"文章简介"},model:{value:t.pram.synopsis,callback:function(e){t.$set(t.pram,"synopsis",e)},expression:"pram.synopsis"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"文章内容",prop:"content",rules:[{required:!0,message:"请填写文章内容",trigger:["blur","change"]}]}},[a("Tinymce",{model:{value:t.pram.content,callback:function(e){t.$set(t.pram,"content",e)},expression:"pram.content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"是否Banner"}},[a("el-switch",{model:{value:t.pram.isBanner,callback:function(e){t.$set(t.pram,"isBanner",e)},expression:"pram.isBanner"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"是否热门"}},[a("el-switch",{model:{value:t.pram.isHot,callback:function(e){t.$set(t.pram,"isHot",e)},expression:"pram.isHot"}})],1),t._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["admin:article:update"],expression:"['admin:article:update']"}],attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.handerSubmit("pram")}}},[t._v("保存")])],1)],1)],1)])],1)},r=[],s=a("8256"),n=a("651a"),l=a("2423"),o=(a("fca7"),a("785a"),a("5f87")),c=a("61f7"),p={components:{Tinymce:s["a"]},data:function(){return{loading:!1,constants:this.$constants,categoryTreeData:[],categoryProps:{value:"id",label:"name",children:"child",expandTrigger:"hover",checkStrictly:!0,emitPath:!1},pram:{author:null,cid:null,content:"",imageInput:"",isBanner:!1,isHot:null,shareSynopsis:null,shareTitle:null,sort:0,synopsis:null,title:null,url:null,id:null},editData:{},myHeaders:{"X-Token":Object(o["a"])()},editorContentLaebl:""}},created:function(){this.tempRoute=Object.assign({},this.$route)},mounted:function(){this.$route.params.id&&(this.getInfo(),this.setTagsViewTitle()),this.handlerGetCategoryTreeData()},methods:{getInfo:function(){var t=this;n["b"]({id:this.$route.params.id}).then((function(e){t.editData=e,t.hadlerInitEditData()}))},modalPicTap:function(t){var e=this;this.$modalUpload((function(t){e.pram.imageInput=t[0].sattDir}),t,"content")},hadlerInitEditData:function(){if(this.$route.params.id){var t=this.editData,e=t.author,a=t.cid,i=t.content,r=t.imageInput,s=t.isBanner,n=t.isHot,l=t.shareSynopsis,o=t.shareTitle,c=t.sort,p=t.synopsis,m=t.title,u=t.url,h=t.id;this.pram.author=e,this.pram.cid=Number.parseInt(a),this.pram.content=i,this.pram.imageInput=r,this.pram.isBanner=s,this.pram.isHot=n,this.pram.shareSynopsis=l,this.pram.shareTitle=o,this.pram.sort=c,this.pram.synopsis=p,this.pram.title=m,this.pram.url=u,this.pram.id=h}},handlerGetCategoryTreeData:function(){var t=this;n["f"]({type:3,status:""}).then((function(e){t.categoryTreeData=e.list,localStorage.setItem("articleClass",JSON.stringify(e.list))}))},handerSubmit:Object(c["a"])((function(t){var e=this;this.$refs[t].validate((function(t){t&&(e.$route.params.id?e.handlerUpdate():e.handlerSave())}))})),handlerUpdate:function(){var t=this;this.loading=!0,this.pram.cid=Array.isArray(this.pram.cid)?this.pram.cid[0]:this.pram.cid,this.pram.shareTitle=this.pram.title,this.pram.shareSynopsis=this.pram.synopsis,l["d"](this.pram).then((function(e){t.$message.success("编辑文章成功"),t.loading=!1,t.$router.push({path:"/content/articleManager"})})).catch((function(){t.loading=!1}))},handlerSave:function(){var t=this;this.loading=!0,this.pram.cid=Array.isArray(this.pram.cid)?this.pram.cid[0]:this.pram.cid,this.pram.shareTitle=this.pram.title,this.pram.shareSynopsis=this.pram.synopsis,l["a"](this.pram).then((function(e){t.$message.success("新增文章成功"),t.loading=!1,t.$router.push({path:"/content/articleManager"})})).catch((function(){t.loading=!1}))},setTagsViewTitle:function(){var t="编辑文章",e=Object.assign({},this.tempRoute,{title:"".concat(t,"-").concat(this.$route.params.id)});this.$store.dispatch("tagsView/updateVisitedView",e)}}},m=p,u=a("2877"),h=Object(u["a"])(m,i,r,!1,null,"3c08c1f2",null);e["default"]=h.exports}}]);